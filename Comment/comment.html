<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.css"
        integrity="sha512-wR4oNhLBHf7smjy0K4oqzdWumd+r5/+6QO/vDda76MW5iug4PT7v86FoEkySIJft3XA0Ae6axhIvHrqwm793Nw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"
        integrity="sha512-17EgCFERpgZKcm0j0fEq1YCJuyAWdz9KUtv1EjVuaOz8pDnh/0nZxmU6BBXwaaxqoi9PQXnRWqlcDB027hgv9A=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />


    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@300&family=Roboto:wght@300;400;500;700&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" rel="preconnect"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" />
    <link rel="stylesheet" href="./main.css">
    <title>Document</title>
</head>

<body>
    <form method="POST" id="frm-comment" data-blog-id="{{id}}" onsubmit="return addComment()">
        <div class="row ">
            <div class="form-group col">
                <label for="name">Name (Required)</label>
                <input type="text" class="form-control form-control-sm " name="name" id="name" placeholder="" required>
            </div>
            <div class="form-group col">
                <label for="email">Email</label>
                <input type="email" class="form-control form-control-sm" name="email" id="email" placeholder="" required>
            </div>
            <div class="col"></div>
        </div>
        <div class="row">
            <div class="form-group col">
                <label for="comment"></label>
                <textarea class="form-control form-control-sm" name="comment" id="comment" rows="3" required></textarea>
            </div>
        </div>
        <div class="row m-0">
            <div class="form-check form-check-inline col">
                <label class="form-check-label">
                    <input class="form-check-input" type="checkbox" name="agree" id="agree" value="false" required> Agree to Terms and Conditions
                </label>
            </div>
            <div class="col text-right">
                <button type="submit" class="btn btn-link btn-sm">Submit Comment</button>
            </div>
        </div>
    </form>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script>
        function addComment(){
            let formData = {
                name: $('#name').val(),
                email: $('#email').val(),
                comment: $('#comment').val(),
                blogId: $('#frm-comment').data('blogId'),
                agree: $('#agree').prop('checked')
            };
            $.ajax({
                url: "https://web1-api.herokuapp.com/users/authenticate",
                dataType: "json",
                type: "POST",
                data: {
                    username: 'test',
                    password: '1c3cr3@m',
                },
                success : function(r){
                    $.ajax({
                        url: "https://web1-api.herokuapp.com/users/comment",
                        dataType: "json",
                        type: "POST",
                        headers: {
                            "Authorization": 'Bearer' + r.token
                        },
                        data: formData,
                        success: function(r){
                            loadDetails(formData.blogId);
                        },
                        error: function(xhr, status, error){
                            window.alert(error);
                        }
                    })
                },

            });
            return false;
        }
    </script>
</body>

</html>